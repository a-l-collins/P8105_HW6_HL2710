---
title: "Homework 6"
author: "Ainsel Levitskaia-Collins, HL2710"
date: "2025-11-22"
output: github_document
---

```{r include = FALSE}
library(tidyverse)
library(p8105.datasets)
data("weather_df")
```

### Problem 2

#### Bootstrapping

Function for sampling for bootstrapping:

```{r}
#' Sample for Bootstrapping
#'
#' @param df Dataframe to sample from
#'
#' @returns A sample selected with replacement for bootstrapping
boot_sample = function(df) {
  sample_frac(df, replace = TRUE)
}
```

Tidying and pulling bootstrap samples from `weather_df`:

```{r}
weather_df <- weather_df %>% 
  janitor::clean_names()

weather_bootstrap <- tibble(strap_number = 1:5000) %>% 
  mutate(
    strap_sample = map(strap_number, \(i) boot_sample(df = weather_df))
  )
```

Creating a variable for $\frac{\hat{\beta}_{1}}{\hat{\beta}_{2}}$:

```{r}
weather_bs_betas <- weather_bootstrap %>% 
  mutate(
    models = map(strap_sample, \(df) lm(tmax ~ tmin + prcp, data = df)),
    results = map(models, broom::tidy)
  ) %>% 
  select(-strap_sample, -models) %>% 
  unnest(results) %>% 
  select(strap_number, term, estimate) %>% 
  pivot_wider(
    names_from = term,
    values_from = estimate
  ) %>% 
  mutate(ratio = tmin / prcp)

head(weather_bs_betas)
```

Collecting $\hat{r}^{2}$ data:

```{r}
weather_bs_rsquared <- weather_bootstrap %>% 
  mutate(
    models = map(strap_sample, \(df) lm(tmax ~ tmin + prcp, data = df)),
    results = map(models, broom::glance)
  ) %>% 
  select(-strap_sample, -models) %>% 
  unnest(results)

head(weather_bs_rsquared)
```

Merging the two `weather_bs` datasets, so that all the information is in one place:

```{r}
weather_bs <- merge(weather_bs_betas, weather_bs_rsquared, by = "strap_number") %>% 
  select(strap_number, ratio, r.squared)

head(weather_bs)
```

#### Plot

- distribution of estimates
- describe these in words
- ID 2.5% and 97.5% quantiles to provide a 95% CI for r^2 and b1/b2

### Problem 3
