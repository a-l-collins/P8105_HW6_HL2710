Homework 6
================
Ainsel Levitskaia-Collins, HL2710
2025-11-22

### Problem 2

#### Bootstrapping

Function for sampling for bootstrapping:

``` r
#' Sample for Bootstrapping
#'
#' @param df Dataframe to sample from
#'
#' @returns A sample selected with replacement for bootstrapping
boot_sample = function(df) {
  sample_frac(df, replace = TRUE)
}
```

Tidying and pulling bootstrap samples from `weather_df`:

``` r
weather_df <- weather_df %>% 
  janitor::clean_names()

weather_bootstrap <- tibble(strap_number = 1:5000) %>% 
  mutate(
    strap_sample = map(strap_number, \(i) boot_sample(df = weather_df))
  )
```

Creating a variable for $\frac{\hat{\beta}_{1}}{\hat{\beta}_{2}}$:

``` r
weather_bs_betas <- weather_bootstrap %>% 
  mutate(
    models = map(strap_sample, \(df) lm(tmax ~ tmin + prcp, data = df)),
    results = map(models, broom::tidy)
  ) %>% 
  select(-strap_sample, -models) %>% 
  unnest(results) %>% 
  select(strap_number, term, estimate) %>% 
  pivot_wider(
    names_from = term,
    values_from = estimate
  ) %>% 
  mutate(ratio = tmin / prcp)

head(weather_bs_betas)
```

    ## # A tibble: 6 × 5
    ##   strap_number `(Intercept)`  tmin     prcp ratio
    ##          <int>         <dbl> <dbl>    <dbl> <dbl>
    ## 1            1          7.77  1.02 -0.00490 -208.
    ## 2            2          7.70  1.03 -0.00600 -171.
    ## 3            3          7.84  1.02 -0.00490 -207.
    ## 4            4          7.79  1.02 -0.00710 -144.
    ## 5            5          7.67  1.02 -0.00380 -269.
    ## 6            6          7.80  1.02 -0.00532 -191.

Collecting $\hat{r}^{2}$ data:

``` r
weather_bs_rsquared <- weather_bootstrap %>% 
  mutate(
    models = map(strap_sample, \(df) lm(tmax ~ tmin + prcp, data = df)),
    results = map(models, broom::glance)
  ) %>% 
  select(-strap_sample, -models) %>% 
  unnest(results)

head(weather_bs_rsquared)
```

    ## # A tibble: 6 × 13
    ##   strap_number r.squared adj.r.squared sigma statistic p.value    df logLik
    ##          <int>     <dbl>         <dbl> <dbl>     <dbl>   <dbl> <dbl>  <dbl>
    ## 1            1     0.943         0.943  2.66    17764.       0     2 -5191.
    ## 2            2     0.942         0.942  2.69    17545.       0     2 -5228.
    ## 3            3     0.942         0.942  2.69    17540.       0     2 -5210.
    ## 4            4     0.940         0.940  2.77    17104.       0     2 -5282.
    ## 5            5     0.942         0.942  2.72    17509.       0     2 -5242.
    ## 6            6     0.942         0.942  2.70    17488.       0     2 -5229.
    ## # ℹ 5 more variables: AIC <dbl>, BIC <dbl>, deviance <dbl>, df.residual <int>,
    ## #   nobs <int>

Merging the two `weather_bs` datasets, so that all the information is in
one place:

``` r
weather_bs <- merge(weather_bs_betas, weather_bs_rsquared, by = "strap_number") %>% 
  select(strap_number, ratio, r.squared)

head(weather_bs)
```

    ##   strap_number     ratio r.squared
    ## 1            1 -208.2850 0.9425873
    ## 2            2 -171.4538 0.9418118
    ## 3            3 -207.4798 0.9419963
    ## 4            4 -143.5437 0.9404779
    ## 5            5 -268.8066 0.9417746
    ## 6            6 -191.0426 0.9416582

#### Plot

- distribution of estimates
- describe these in words
- ID 2.5% and 97.5% quantiles to provide a 95% CI for r^2 and b1/b2

### Problem 3
